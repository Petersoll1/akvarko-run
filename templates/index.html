<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chytr√© Akv√°rium</title>
    <meta http-equiv="refresh" content="5">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0e1a;
            --bg-secondary: #111827;
            --card-bg: #1a1f2e;
            --card-border: #2d3548;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --accent: #22d3ee;
            --accent-glow: rgba(34, 211, 238, 0.3);
            --success: #10b981;
            --success-glow: rgba(16, 185, 129, 0.3);
            --danger: #ef4444;
            --danger-glow: rgba(239, 68, 68, 0.4);
            --warning: #f59e0b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body { 
            font-family: 'Montserrat', sans-serif; 
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary); 
            min-height: 100vh;
            padding: 30px 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Styly z√°hlav√≠ */
        .header { 
            text-align: center; 
            margin-bottom: 50px;
            padding: 30px;
            background: var(--card-bg);
            border-radius: 24px;
            border: 1px solid var(--card-border);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .header h1 { 
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent) 0%, #818cf8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            letter-spacing: -0.5px;
        }

        .header-subtitle {
            color: var(--text-secondary);
            font-size: 0.95rem;
            font-weight: 400;
            margin-bottom: 20px;
        }

        .status-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .status-badge { 
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px; 
            border-radius: 50px; 
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
        }

        .status-badge.online {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(16, 185, 129, 0.1) 100%);
            border: 1px solid var(--success);
            color: var(--success);
            box-shadow: 0 0 20px var(--success-glow);
        }

        .status-badge.offline {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2) 0%, rgba(239, 68, 68, 0.1) 100%);
            border: 1px solid var(--danger);
            color: var(--danger);
            box-shadow: 0 0 20px var(--danger-glow);
        }

        .status-badge.alert {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.2) 0%, rgba(245, 158, 11, 0.1) 100%);
            border: 1px solid var(--warning);
            color: var(--warning);
            animation: pulse 2s infinite;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            animation: blink 1.5s infinite;
        }

        .status-dot.online { background: var(--success); }
        .status-dot.offline { background: var(--danger); }

        .device-name {
            color: var(--text-muted);
            font-size: 0.85rem;
            font-weight: 500;
        }

        /* Rozlo≈æen√≠ m≈ô√≠≈æky */
        .grid { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr);
            gap: 25px; 
            margin-bottom: 40px;
        }

        @media (max-width: 900px) {
            .grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 600px) {
            .grid {
                grid-template-columns: 1fr;
            }
            .header h1 {
                font-size: 1.8rem;
            }
        }

        /* Styly karet */
        .card { 
            background: var(--card-bg);
            padding: 30px;
            border-radius: 24px;
            border: 1px solid var(--card-border);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent), #818cf8);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 60px -15px rgba(0, 0, 0, 0.5);
        }

        .card:hover::before {
            opacity: 1;
        }

        /* Styly v√Ωstra≈æn√Ωch karet */
        .card.alert {
            border: 2px solid var(--danger);
            box-shadow: 
                0 0 30px var(--danger-glow),
                0 0 60px var(--danger-glow),
                inset 0 0 30px rgba(239, 68, 68, 0.05);
            animation: alertGlow 2s ease-in-out infinite;
        }

        .card.alert::before {
            background: var(--danger);
            opacity: 1;
        }

        .card.alert .value {
            color: var(--danger);
        }

        @keyframes alertGlow {
            0%, 100% { box-shadow: 0 0 30px var(--danger-glow), 0 0 60px var(--danger-glow); }
            50% { box-shadow: 0 0 40px var(--danger-glow), 0 0 80px var(--danger-glow); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        /* Ikona karty */
        .card-icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 15px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            background: linear-gradient(135deg, rgba(34, 211, 238, 0.15) 0%, rgba(129, 140, 248, 0.15) 100%);
            border: 1px solid rgba(34, 211, 238, 0.2);
        }

        .card.alert .card-icon {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2) 0%, rgba(239, 68, 68, 0.1) 100%);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .label { 
            color: var(--text-secondary); 
            text-transform: uppercase; 
            letter-spacing: 1.5px; 
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .value { 
            font-size: 3.5rem; 
            font-weight: 700; 
            margin: 15px 0; 
            color: var(--accent);
            line-height: 1;
        }

        .unit { 
            font-size: 0.35em; 
            color: var(--text-secondary);
            font-weight: 500;
            margin-left: 5px;
        }

        .status-text {
            font-size: 0.85rem;
            font-weight: 500;
            padding: 6px 14px;
            border-radius: 20px;
            display: inline-block;
        }

        .status-text.ok {
            color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        .status-text.warning {
            color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
        }

        .range-info {
            margin-top: 12px;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Indik√°tor stavu rel√© */
        .relay-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin: 15px 0;
        }

        .relay-indicator {
            width: 60px;
            height: 30px;
            border-radius: 15px;
            position: relative;
            transition: all 0.3s ease;
        }

        .relay-indicator.off {
            background: linear-gradient(135deg, #374151 0%, #1f2937 100%);
            border: 1px solid #4b5563;
        }

        .relay-indicator.on {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
            border: 1px solid var(--success);
            box-shadow: 0 0 15px var(--success-glow);
        }

        .relay-indicator::after {
            content: '';
            position: absolute;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            top: 2px;
            transition: all 0.3s ease;
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .relay-indicator.off::after {
            left: 3px;
        }

        .relay-indicator.on::after {
            left: 33px;
        }

        .relay-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .relay-state {
            font-size: 0.75rem;
            font-weight: 500;
            padding: 4px 10px;
            border-radius: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .relay-state.on {
            color: var(--success);
            background: rgba(16, 185, 129, 0.15);
        }

        .relay-state.off {
            color: var(--text-muted);
            background: rgba(100, 116, 139, 0.15);
        }

        /* Ukazatel hladiny vody */
        .water-level-bar {
            width: 100%;
            height: 12px;
            background: #1f2937;
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
            border: 1px solid var(--card-border);
        }

        .water-level-fill {
            height: 100%;
            border-radius: 6px;
            transition: width 0.5s ease, background 0.3s ease;
        }

        .water-level-fill.ok {
            background: linear-gradient(90deg, var(--accent), #818cf8);
        }

        .water-level-fill.low {
            background: linear-gradient(90deg, var(--danger), #f87171);
        }

        /* Ovl√°d√°n√≠ termostatu */
        .thermostat-card {
            margin-bottom: 40px;
            padding: 40px;
            background: linear-gradient(145deg, #1a1f2e 0%, #0f1318 100%);
            border-radius: 32px;
            border: 1px solid var(--card-border);
            box-shadow: 0 30px 60px -15px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }

        .thermostat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #3b82f6, var(--accent), #f59e0b);
        }

        .thermostat-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 35px;
        }

        .thermostat-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent) 0%, #818cf8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .thermostat-content {
            display: grid;
            grid-template-columns: 1fr 1.5fr 1fr;
            gap: 40px;
            align-items: center;
        }

        @media (max-width: 900px) {
            .thermostat-content {
                grid-template-columns: 1fr;
                gap: 30px;
            }
        }

        /* Zobrazen√≠ aktu√°ln√≠ teploty */
        .current-temp-section {
            text-align: center;
            padding: 25px;
            background: rgba(34, 211, 238, 0.05);
            border-radius: 24px;
            border: 1px solid rgba(34, 211, 238, 0.15);
        }

        .current-temp-section.alert {
            background: rgba(239, 68, 68, 0.08);
            border: 1px solid rgba(239, 68, 68, 0.3);
            box-shadow: 0 0 30px var(--danger-glow);
        }

        .current-temp-label {
            font-size: 0.7rem;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .current-temp-section.alert .current-temp-label {
            color: var(--danger);
        }

        .current-temp-value {
            font-size: 4.5rem;
            font-weight: 700;
            color: #ffffff;
            line-height: 1;
            text-shadow: 0 0 40px rgba(255, 255, 255, 0.1);
        }

        .current-temp-section.alert .current-temp-value {
            color: var(--danger);
        }

        .current-temp-unit {
            font-size: 0.35em;
            color: var(--text-secondary);
            font-weight: 400;
            vertical-align: super;
        }

        .temp-status-badge {
            margin-top: 15px;
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .temp-status-badge.ok {
            color: var(--success);
            background: rgba(16, 185, 129, 0.15);
        }

        .temp-status-badge.warning {
            color: var(--danger);
            background: rgba(239, 68, 68, 0.15);
        }

        /* Ovl√°d√°n√≠ c√≠lov√© teploty */
        .target-temp-section {
            text-align: center;
        }

        .target-temp-label {
            font-size: 0.7rem;
            color: var(--warning);
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .target-temp-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        .temp-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid var(--card-border);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .temp-btn:hover {
            border-color: var(--warning);
            background: rgba(245, 158, 11, 0.1);
            transform: scale(1.1);
        }

        .temp-btn:active {
            transform: scale(0.95);
        }

        .target-temp-value {
            font-size: 3rem;
            font-weight: 700;
            color: var(--warning);
            min-width: 120px;
        }

        .target-temp-value .unit {
            font-size: 0.4em;
            color: var(--text-secondary);
        }

        .slider-wrapper {
            padding: 0 10px;
        }

        .temp-slider {
            -webkit-appearance: none;
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: linear-gradient(90deg, #3b82f6 0%, #22d3ee 35%, #10b981 50%, #f59e0b 75%, #ef4444 100%);
            outline: none;
            transition: all 0.3s ease;
        }

        .temp-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: linear-gradient(145deg, #ffffff 0%, #e0e0e0 100%);
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            transition: all 0.2s ease;
            border: 3px solid var(--warning);
        }

        .temp-slider::-webkit-slider-thumb:hover {
            transform: scale(1.15);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
        }

        .temp-slider::-moz-range-thumb {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: linear-gradient(145deg, #ffffff 0%, #e0e0e0 100%);
            cursor: pointer;
            border: 3px solid var(--warning);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.7rem;
            color: var(--text-muted);
        }

        .status-saved {
            margin-top: 15px;
            font-size: 0.8rem;
            color: var(--success);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .status-saved.show {
            opacity: 1;
        }

        /* Sekce stavu topen√≠ */
        .heater-section {
            text-align: center;
            padding: 25px;
            border-radius: 24px;
            transition: all 0.5s ease;
        }

        .heater-section.heating {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            box-shadow: 
                0 0 30px rgba(239, 68, 68, 0.2),
                inset 0 0 30px rgba(239, 68, 68, 0.05);
        }

        .heater-section.idle {
            background: rgba(100, 116, 139, 0.1);
            border: 1px solid rgba(100, 116, 139, 0.2);
        }

        .heater-icon-wrapper {
            width: 80px;
            height: 80px;
            margin: 0 auto 15px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            transition: all 0.5s ease;
        }

        .heater-section.heating .heater-icon-wrapper {
            background: linear-gradient(145deg, rgba(239, 68, 68, 0.3) 0%, rgba(239, 68, 68, 0.1) 100%);
            box-shadow: 0 0 40px rgba(239, 68, 68, 0.4);
            animation: heaterPulse 1.5s ease-in-out infinite;
        }

        .heater-section.idle .heater-icon-wrapper {
            background: rgba(100, 116, 139, 0.15);
        }

        @keyframes heaterPulse {
            0%, 100% { box-shadow: 0 0 30px rgba(239, 68, 68, 0.3); }
            50% { box-shadow: 0 0 50px rgba(239, 68, 68, 0.6); }
        }

        .heater-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .heater-status-text {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .heater-section.heating .heater-status-text {
            color: var(--danger);
        }

        .heater-section.idle .heater-status-text {
            color: var(--text-muted);
        }

        .heater-gpio {
            margin-top: 10px;
            font-size: 0.65rem;
            color: var(--text-muted);
            font-family: monospace;
        }

        /* Styly ve footeru */
        .footer { 
            text-align: center;
            padding: 25px;
            background: var(--card-bg);
            border-radius: 16px;
            border: 1px solid var(--card-border);
        }

        .footer-content {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        .footer-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        .footer-item strong {
            color: var(--text-secondary);
            font-weight: 600;
        }

        .refresh-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--accent);
            font-size: 0.8rem;
        }

        .refresh-dot {
            width: 8px;
            height: 8px;
            background: var(--accent);
            border-radius: 50%;
            animation: blink 1s infinite;
        }

        /* Sekce Chytr√Ω r√°dce */
        .advisor-card {
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(145deg, #1a1f2e 0%, #0f1318 100%);
            border-radius: 24px;
            border: 1px solid var(--card-border);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
        }

        .advisor-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 25px;
        }

        .advisor-header h2 {
            font-size: 1.3rem;
            font-weight: 700;
            background: linear-gradient(135deg, #10b981 0%, #22d3ee 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .advice-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .advice-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 15px 20px;
            border-radius: 12px;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .advice-item.ok {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: var(--success);
        }

        .advice-item.warning {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: var(--warning);
        }

        .advice-item.danger {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: var(--danger);
        }

        .advice-icon {
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        /* Nastaven√≠ objemu akv√°ria */
        .volume-section {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid var(--card-border);
        }

        .volume-label {
            font-size: 0.7rem;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
        }

        .volume-input-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .volume-input {
            width: 80px;
            padding: 10px 15px;
            font-size: 1.2rem;
            font-weight: 600;
            text-align: center;
            background: var(--bg-secondary);
            border: 2px solid var(--card-border);
            border-radius: 12px;
            color: var(--text-primary);
            outline: none;
            transition: all 0.3s ease;
        }

        .volume-input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 15px var(--accent-glow);
        }

        .volume-unit {
            font-size: 1rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Sekce Vƒõdeck√° anal√Ωza */
        .science-card {
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(145deg, #1a1f2e 0%, #0f1318 100%);
            border-radius: 24px;
            border: 1px solid var(--card-border);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
        }

        .science-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 30px;
        }

        .science-header h2 {
            font-size: 1.3rem;
            font-weight: 700;
            background: linear-gradient(135deg, #818cf8 0%, #c084fc 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .science-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
        }

        @media (max-width: 900px) {
            .science-grid {
                grid-template-columns: 1fr;
            }
        }

        .science-metric {
            text-align: center;
            padding: 25px;
            border-radius: 20px;
            background: rgba(129, 140, 248, 0.05);
            border: 1px solid rgba(129, 140, 248, 0.15);
        }

        .metric-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .metric-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .metric-value {
            font-size: 3rem;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 8px;
        }

        .metric-value.excellent {
            color: var(--success);
        }

        .metric-value.good {
            color: #22d3ee;
        }

        .metric-value.warning {
            color: var(--warning);
        }

        .metric-value.danger {
            color: var(--danger);
        }

        .metric-unit {
            font-size: 0.4em;
            color: var(--text-secondary);
            font-weight: 400;
        }

        .metric-description {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .metric-description.excellent {
            color: var(--success);
        }

        .metric-description.good {
            color: #22d3ee;
        }

        .metric-description.warning {
            color: var(--warning);
        }

        /* WQI Gauge */
        .wqi-gauge {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto 15px;
        }

        .wqi-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                var(--success) 0deg,
                var(--success) calc(var(--wqi-percent, 0) * 3.6deg),
                rgba(100, 116, 139, 0.2) calc(var(--wqi-percent, 0) * 3.6deg),
                rgba(100, 116, 139, 0.2) 360deg
            );
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .wqi-inner {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: var(--card-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .wqi-number {
            font-size: 2rem;
            font-weight: 700;
            line-height: 1;
        }

        .wqi-percent {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .history-info {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid var(--card-border);
            text-align: center;
            font-size: 0.75rem;
            color: var(--text-muted);
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üê† Chytr√© Akv√°rium</h1>
            <p class="header-subtitle">Dashboard pro SOƒå a roƒçn√≠kovou pr√°ci ≈æ√°k≈Ø Petr Eli√°≈° a V√≠t Forman.</p>
            <div class="status-container">
                <span class="status-badge {{ 'online' if data.status == 'Online' else 'offline' }}">
                    <span class="status-dot {{ 'online' if data.status == 'Online' else 'offline' }}"></span>
                    Syst√©m: {{ data.status }}
                </span>
                {% if data.global_alert %}
                <span class="status-badge alert">
                    ‚ö†Ô∏è Aktivn√≠ v√Ωstraha
                </span>
                {% endif %}
                <span class="device-name">üì° {{ data.device_name }}</span>
            </div>
        </header>

        <!-- Termostat -->
        <section class="thermostat-card">
            <div class="thermostat-header">
                <span style="font-size: 2rem;">üå°Ô∏è</span>
                <h2>Chytr√Ω termostat</h2>
            </div>
            <div class="thermostat-content">
                <!-- Aktu√°ln√≠ teplota -->
                <div class="current-temp-section {{ 'alert' if data.temp_alert else '' }}">
                    <div class="current-temp-label">Aktu√°ln√≠ teplota</div>
                    <div class="current-temp-value">
                        {% if data.temp == -127 %}--{% else %}{{ data.temp }}{% endif %}<span class="current-temp-unit">¬∞C</span>
                    </div>
                    {% if data.temp_alert %}
                    <span class="temp-status-badge warning">‚ö†Ô∏è Mimo rozsah</span>
                    {% else %}
                    <span class="temp-status-badge ok">‚úì V normƒõ</span>
                    {% endif %}
                </div>

                <!-- C√≠lov√° teplota -->
                <div class="target-temp-section">
                    <div class="target-temp-label">üéØ C√≠lov√° teplota</div>
                    <div class="target-temp-display">
                        <button class="temp-btn" id="tempDown">‚àí</button>
                        <div class="target-temp-value">
                            <span id="targetValue">{{ data.target_temp }}</span><span class="unit">¬∞C</span>
                        </div>
                        <button class="temp-btn" id="tempUp">+</button>
                    </div>
                    <div class="slider-wrapper">
                        <input type="range" 
                               id="tempSlider" 
                               class="temp-slider" 
                               min="18" 
                               max="30" 
                               step="0.5" 
                               value="{{ data.target_temp }}">
                        <div class="slider-labels">
                            <span>ü•∂ 18¬∞C</span>
                            <span>üëå 24¬∞C</span>
                            <span>üî• 30¬∞C</span>
                        </div>
                    </div>
                    <span id="statusSaved" class="status-saved">‚úì Ulo≈æeno</span>
                </div>

                <!-- Stav topen√≠ -->
                <div class="heater-section {{ 'heating' if data.heater_state else 'idle' }}" id="heaterSection">
                    <div class="heater-icon-wrapper">
                        {{ 'üî•' if data.heater_state else '‚ùÑÔ∏è' }}
                    </div>
                    <div class="heater-label">Stav topen√≠</div>
                    <div class="heater-status-text" id="heaterText">
                        {{ 'TOP√ç SE' if data.heater_state else 'VYPNUTO' }}
                    </div>
                    <div class="heater-gpio">GPIO 26</div>
                </div>
            </div>
        </section>

        <!-- Chytr√Ω r√°dce -->
        <section class="advisor-card">
            <div class="advisor-header">
                <span style="font-size: 1.8rem;">üß†</span>
                <h2>Chytr√Ω r√°dce</h2>
            </div>
            
            <div class="advice-list">
                {% for item in data.advice %}
                <div class="advice-item {{ item.type }}">
                    <span class="advice-icon">
                        {% if item.type == 'ok' %}‚úÖ{% elif item.type == 'danger' %}üö®{% else %}‚ö†Ô∏è{% endif %}
                    </span>
                    <span>{{ item.text }}</span>
                </div>
                {% endfor %}
                {% if not data.advice %}
                <div class="advice-item ok">
                    <span class="advice-icon">‚úÖ</span>
                    <span>ƒåek√°m na data ze senzor≈Ø...</span>
                </div>
                {% endif %}
            </div>

            <div class="volume-section">
                <div class="volume-label">üìè Objem akv√°ria</div>
                <div class="volume-input-wrapper">
                    <input type="number" 
                           id="volumeInput" 
                           class="volume-input" 
                           min="1" 
                           max="1000" 
                           value="{{ data.tank_volume }}">
                    <span class="volume-unit">litr≈Ø</span>
                </div>
            </div>
        </section>

        <!-- Vƒõdeck√° anal√Ωza biotopu -->
        <section class="science-card">
            <div class="science-header">
                <span style="font-size: 1.8rem;">üß¨</span>
                <h2>Vƒõdeck√° anal√Ωza biotopu</h2>
            </div>
            
            <div class="science-grid">
                <!-- WQI Index -->
                <div class="science-metric">
                    <div class="metric-icon">üìä</div>
                    <div class="metric-label">Index kvality vody (WQI)</div>
                    <div class="wqi-gauge">
                        <div class="wqi-circle" style="--wqi-percent: {{ data.wqi }};">
                            <div class="wqi-inner">
                                <span class="wqi-number {% if data.wqi >= 80 %}excellent{% elif data.wqi >= 60 %}good{% elif data.wqi >= 40 %}warning{% else %}danger{% endif %}">{{ data.wqi }}</span>
                                <span class="wqi-percent">%</span>
                            </div>
                        </div>
                    </div>
                    <div class="metric-description {% if data.wqi >= 80 %}excellent{% elif data.wqi >= 60 %}good{% else %}warning{% endif %}">
                        {% if data.wqi >= 80 %}Vynikaj√≠c√≠ kvalita{% elif data.wqi >= 60 %}Dobr√° kvalita{% elif data.wqi >= 40 %}Pr≈Ømƒõrn√° kvalita{% else %}≈†patn√° kvalita{% endif %}
                    </div>
                </div>

                <!-- Tepeln√° stabilita -->
                <div class="science-metric">
                    <div class="metric-icon">üå°Ô∏è</div>
                    <div class="metric-label">Tepeln√° stabilita</div>
                    <div class="metric-value {% if data.temp_stability < 0.5 %}excellent{% elif data.temp_stability < 1.0 %}good{% else %}warning{% endif %}">
                        {{ "%.2f"|format(data.temp_stability) }}<span class="metric-unit">œÉ ¬∞C</span>
                    </div>
                    <div class="metric-description {% if data.temp_stability < 0.5 %}excellent{% elif data.temp_stability < 1.0 %}good{% else %}warning{% endif %}">
                        {{ data.temp_stability_text }}
                    </div>
                </div>

                <!-- Predikce √∫dr≈æby -->
                <div class="science-metric">
                    <div class="metric-icon">üîÆ</div>
                    <div class="metric-label">Predikce √∫dr≈æby</div>
                    {% if data.tds_prediction_days is not none %}
                        {% if data.tds_prediction_days == 0 %}
                        <div class="metric-value danger">
                            Nyn√≠<span class="metric-unit"></span>
                        </div>
                        <div class="metric-description warning">V√Ωmƒõna vody nutn√° ihned!</div>
                        {% elif data.tds_prediction_days <= 3 %}
                        <div class="metric-value warning">
                            {{ data.tds_prediction_days }}<span class="metric-unit">dn√≠</span>
                        </div>
                        <div class="metric-description warning">Bl√≠≈æ√≠ se v√Ωmƒõna vody</div>
                        {% else %}
                        <div class="metric-value good">
                            {{ data.tds_prediction_days }}<span class="metric-unit">dn√≠</span>
                        </div>
                        <div class="metric-description good">Do dal≈°√≠ v√Ωmƒõny vody</div>
                        {% endif %}
                    {% else %}
                    <div class="metric-value good">
                        ‚Äî<span class="metric-unit"></span>
                    </div>
                    <div class="metric-description">Sb√≠r√°m data pro predikci...</div>
                    {% endif %}
                </div>
            </div>

            <div class="history-info">
                üìà Historick√Ωch z√°znam≈Ø: {{ data.history_count }} / 2000 (vzorkov√°n√≠ 1√ó za minutu)
            </div>
        </section>

        <div class="grid">
            <!-- Kyselost (pH) -->
            <div class="card {{ 'alert' if data.ph_alert else '' }}">
                <div class="card-icon">‚öóÔ∏è</div>
                <div class="label">Kyselost (pH)</div>
                <div class="value">{{ "%.1f"|format(data.ph) }}<span class="unit">pH</span></div>
                {% if data.ph_alert %}
                <span class="status-text warning">‚ö†Ô∏è Mimo rozsah</span>
                {% else %}
                <span class="status-text ok">‚úì V normƒõ</span>
                {% endif %}
                <div class="range-info">Optim√°ln√≠ rozsah: 6.5 - 7.5 pH</div>
            </div>

            <!-- Z√°kal vody (NTU - Nephelometric Turbidity Units) -->
            <div class="card {{ 'alert' if data.turbidity_alert else '' }}">
                <div class="card-icon">üíß</div>
                <div class="label">Z√°kal vody</div>
                <div class="value">{{ "%.1f"|format(data.turbidity) }}<span class="unit">NTU</span></div>
                {% if data.turbidity_alert %}
                <span class="status-text warning">‚ö†Ô∏è Vysok√Ω z√°kal</span>
                {% else %}
                <span class="status-text ok">‚úì ƒåist√° voda</span>
                {% endif %}
                <div class="range-info">Doporuƒçeno: &lt; 30 NTU</div>
            </div>

            <!-- TDS -->
            <div class="card {{ 'alert' if data.tds_alert else '' }}">
                <div class="card-icon">üß™</div>
                <div class="label">TDS (Rozpu≈°tƒõn√© l√°tky)</div>
                <div class="value">{{ data.tds }}<span class="unit">ppm</span></div>
                {% if data.tds_alert %}
                <span class="status-text warning">‚ö†Ô∏è Vysok√° hodnota</span>
                {% else %}
                <span class="status-text ok">‚úì V normƒõ</span>
                {% endif %}
                <div class="range-info">Maxim√°ln√≠ hodnota: &lt; 500 ppm</div>
            </div>

            <!-- Hladina vody -->
            <div class="card {{ 'alert' if data.water_level_alert else '' }}">
                <div class="card-icon">üìä</div>
                <div class="label">Hladina vody</div>
                <div class="value">{{ data.water_level }}<span class="unit">%</span></div>
                <div class="water-level-bar">
                    <div class="water-level-fill {{ 'low' if data.water_level_alert else 'ok' }}" id="water-fill"></div>
                </div>
                {% if data.water_level_alert %}
                <span class="status-text warning">‚ö†Ô∏è N√≠zk√° hladina</span>
                {% else %}
                <span class="status-text ok">‚úì OK</span>
                {% endif %}
                <div class="range-info">Minim√°ln√≠ hladina: 20%</div>
            </div>

            <!-- Stav rel√© -->
            <div class="card">
                <div class="card-icon">üîå</div>
                <div class="label">Stav rel√©</div>
                
                <!-- ƒåerpadlo -->
                <div class="relay-status">
                    <span class="relay-label">ƒåerpadlo</span>
                    <div class="relay-indicator {{ 'on' if data.pump_state else 'off' }}"></div>
                    <span class="relay-state {{ 'on' if data.pump_state else 'off' }}">
                        {{ 'Zapnuto' if data.pump_state else 'Vypnuto' }}
                    </span>
                </div>
                
                <!-- Topen√≠ -->
                <div class="relay-status">
                    <span class="relay-label">Topen√≠</span>
                    <div class="relay-indicator {{ 'on' if data.heater_state else 'off' }}"></div>
                    <span class="relay-state {{ 'on' if data.heater_state else 'off' }}">
                        {{ 'Zapnuto' if data.heater_state else 'Vypnuto' }}
                    </span>
                </div>
            </div>
        </div>

        <footer class="footer">
            <div class="footer-content">
                <div class="footer-item">
                    <span>üïê</span>
                    <strong>Posledn√≠ aktualizace:</strong>
                    <span>{{ data.last_update }}</span>
                </div>
                <div class="footer-item">
                    <span>üë®‚Äçüéì</span>
                    <strong>Projekt:</strong>
                    <span>SOƒå - Elias Forman</span>
                </div>
                <div class="refresh-indicator">
                    <span class="refresh-dot"></span>
                    Auto-refresh: 5s
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Nastaven√≠ ≈°√≠≈ôky ukazatele hladiny vody
        document.getElementById('water-fill').style.width = '{{ data.water_level }}%';
        
        // Ovl√°d√°n√≠ termostatu
        const targetValue = document.getElementById('targetValue');
        const tempSlider = document.getElementById('tempSlider');
        const tempUp = document.getElementById('tempUp');
        const tempDown = document.getElementById('tempDown');
        const statusSaved = document.getElementById('statusSaved');
        const volumeInput = document.getElementById('volumeInput');
        let currentTarget = parseFloat('{{ data.target_temp }}');
        let currentVolume = parseInt('{{ data.tank_volume }}');
        let saveTimeout;

        // Aktualizace zobrazen√≠
        function updateDisplay() {
            targetValue.textContent = currentTarget.toFixed(1);
            tempSlider.value = currentTarget;
        }

        // Tlaƒç√≠tka +/-
        tempUp.addEventListener('click', function() {
            if (currentTarget < 30) {
                currentTarget = Math.min(30, currentTarget + 0.5);
                updateDisplay();
                sendTargetTemp(currentTarget);
            }
        });

        tempDown.addEventListener('click', function() {
            if (currentTarget > 18) {
                currentTarget = Math.max(18, currentTarget - 0.5);
                updateDisplay();
                sendTargetTemp(currentTarget);
            }
        });

        // Posuvn√≠k
        tempSlider.addEventListener('input', function() {
            currentTarget = parseFloat(this.value);
            updateDisplay();
            sendTargetTemp(currentTarget);
        });

        // Odesl√°n√≠ c√≠lov√© teploty na server
        async function sendTargetTemp(value) {
            clearTimeout(saveTimeout);
            
            saveTimeout = setTimeout(async () => {
                try {
                    const response = await fetch('http://192.168.50.212:8000/set_target', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ target_temp: parseFloat(value) })
                    });
                    
                    if (response.ok) {
                        statusSaved.classList.add('show');
                        setTimeout(() => {
                            statusSaved.classList.remove('show');
                        }, 2000);
                    }
                } catch (error) {
                    console.error('Chyba p≈ôi nastavov√°n√≠ c√≠lov√© teploty:', error);
                }
            }, 300);
        }

        // Odesl√°n√≠ objemu akv√°ria na server
        async function sendVolume(value) {
            try {
                const response = await fetch('http://192.168.50.212:8000/set_target', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ tank_volume: parseInt(value) })
                });
                
                if (response.ok) {
                    statusSaved.classList.add('show');
                    setTimeout(() => {
                        statusSaved.classList.remove('show');
                    }, 2000);
                }
            } catch (error) {
                console.error('Chyba p≈ôi nastavov√°n√≠ objemu:', error);
            }
        }

        // Zmƒõna objemu akv√°ria
        volumeInput.addEventListener('change', function() {
            currentVolume = parseInt(this.value) || 50;
            if (currentVolume < 1) currentVolume = 1;
            if (currentVolume > 1000) currentVolume = 1000;
            this.value = currentVolume;
            sendVolume(currentVolume);
        });

        // Odpoƒçet automatick√©ho obnoven√≠
        let countdown = 5;
        const refreshIndicator = document.querySelector('.refresh-indicator');
        
        setInterval(() => {
            countdown--;
            if (countdown <= 0) countdown = 5;
        }, 1000);

        // Dynamick√° zmƒõna barvy statusu syst√©mu podle stavu p≈ôipojen√≠ ESP32
        const statusBadge = document.querySelector('.status-badge');
        if (statusBadge) {
            const statusText = statusBadge.textContent.toLowerCase();
            if (statusText.includes('online')) {
                statusBadge.classList.remove('offline');
                statusBadge.classList.add('online');
            } else {
                statusBadge.classList.remove('online');
                statusBadge.classList.add('offline');
            }
        }
    </script>
</body>
</html>
